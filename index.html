<!DOCTYPE html>
<html>
<head>
	<title>Beneva Web2Print</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
	<link rel="stylesheet" type="text/css" href="styles.css">
</head>
<body>
	<div id="bg"></div>
	<div id="overlay"></div>
	<div class="input" id="in-1" style="left:105px;top:65px;width:540px;">
		<input type="text" tabindex="-1" style="font-size:130px;height:145px;width:100%;text-align:center;letter-spacing:-12px;" size="18">
		<a href="#logo" class="prev"><button class="btn btn-primary">&lt;</button></a>
		<a href="#in-2" class="next"><button class="btn btn-primary">&gt;</button></a>
	</div>
	<div class="input" id="in-2" style="left:129px;top:209px;width:492px;">
		<input type="text" tabindex="2" style="font-size:30px;height:40px;width:100%;font-style:italic;text-align:center;">
		<a href="#in-1" class="prev"><button class="btn btn-primary">&lt;</button></a>
		<a href="#in-3" class="next"><button class="btn btn-primary">&gt;</button></a>
	</div>
	<div class="input" id="in-3" style="left:215px;top:438px;width:90px;">
		<input type="text" tabindex="3" style="font-size:20px;height:25px;width:100%;text-transform:uppercase;">
		<a href="#in-2" class="prev"><button class="btn btn-primary">&lt;</button></a>
		<a href="#in-4" class="next"><button class="btn btn-primary">&gt;</button></a>
	</div>
	<div class="input" id="in-4" style="left:402px;top:298px;width:171px;">
		<input type="text" tabindex="4" style="font-size:35px;height:45px;width:100%;text-align:center;text-transform:uppercase;">
		<a href="#in-3" class="prev"><button class="btn btn-primary">&lt;</button></a>
		<a href="#in-5" class="next"><button class="btn btn-primary">&gt;</button></a>
	</div>
	<div class="input" id="in-5" style="left:1333px;top:115px;width:460px;">
		<input type="text" style="font-size:58px;height:75px;width:100%;font-weight:bold;">
		<a href="#in-4" class="prev"><button class="btn btn-primary">&lt;</button></a>
		<a href="#in-6" class="next"><button class="btn btn-primary">&gt;</button></a>
	</div>
	<div class="input" id="in-6" style="left:1333px;top:188px;width:460px;">
		<textarea style="font-size:37px;line-height:46px;height:200px;width:100%;"></textarea>
		<a href="#in-5" class="prev"><button class="btn btn-primary">&lt;</button></a>
		<a href="#in-7" class="next"><button class="btn btn-primary">&gt;</button></a>
	</div>
	<div class="input" id="in-7" style="left:1442px;top:403px;width:460px;">
		<input type="text" style="font-size:52px;height:67px;width:100%;font-weight:bold;text-align:right;">
		<a href="#in-6" class="prev"><button class="btn btn-primary">&lt;</button></a>
		<a href="#in-8" class="next"><button class="btn btn-primary">&gt;</button></a>
	</div>
	<div class="input" id="in-8" style="left:1442px;top:473px;width:460px;">
		<textarea style="font-size:37px;line-height:46px;height:200px;width:100%;text-align:right;"></textarea>
		<a href="#in-7" class="prev"><button class="btn btn-primary">&lt;</button></a>
		<a href="#in-9" class="next"><button class="btn btn-primary">&gt;</button></a>
	</div>
	<div class="input" id="in-9" style="left:628px;top:654px;width:460px;">
		<input type="text" style="font-size:56px;height:78px;width:100%;font-weight:bold;">
		<a href="#in-8" class="prev"><button class="btn btn-primary">&lt;</button></a>
		<a href="#in-10" class="next"><button class="btn btn-primary">&gt;</button></a>
	</div>
	<div class="input" id="in-10" style="left:628px;top:719px;width:460px;">
		<textarea style="font-size:37px;line-height:46px;height:200px;width:100%;"></textarea>
		<a href="#in-9" class="prev"><button class="btn btn-primary">&lt;</button></a>
		<a href="#in-10" class="next"><button class="btn btn-primary">&gt;</button></a>
	</div>
	<div class="input" id="in-11" style="left:852px;top:929px;width:460px;">
		<input type="text" style="font-size:57px;height:75px;width:100%;font-weight:bold;text-align:right;">
		<a href="#in-10" class="prev"><button class="btn btn-primary">&lt;</button></a>
		<a href="#in-12" class="next"><button class="btn btn-primary">&gt;</button></a>
	</div>
	<div class="input" id="in-12" style="left:852px;top:1006px;width:460px;">
		<textarea style="font-size:37px;line-height:46px;height:200px;width:100%;text-align:right;"></textarea>
		<a href="#in-11" class="prev"><button class="btn btn-primary">&lt;</button></a>
		<a href="#in-13" class="next"><button class="btn btn-primary">&gt;</button></a>
	</div>
	<div class="input" id="in-13" style="left:1279px;top:1537px;width:460px;">
		<input type="text" style="font-size:57px;height:75px;width:100%;font-weight:bold;">
		<a href="#in-12" class="prev"><button class="btn btn-primary">&lt;</button></a>
		<a href="#in-14" class="next"><button class="btn btn-primary">&gt;</button></a>
	</div>
	<div class="input" id="in-14" style="left:1279px;top:1605px;width:460px;">
		<textarea style="font-size:37px;line-height:46px;height:200px;width:100%;"></textarea>
		<a href="#in-13" class="prev"><button class="btn btn-primary">&lt;</button></a>
		<a href="#in-15" class="next"><button class="btn btn-primary">&gt;</button></a>
	</div>
	<div class="input" id="in-15" style="left:2121px;top:1309px;width:460px;">
		<input type="text" style="font-size:57px;height:75px;width:100%;font-weight:bold;text-align:right;">
		<a href="#in-14" class="prev"><button class="btn btn-primary">&lt;</button></a>
		<a href="#in-16" class="next"><button class="btn btn-primary">&gt;</button></a>
	</div>
	<div class="input" id="in-16" style="left:2121px;top:1380px;width:460px;">
		<textarea style="font-size:37px;line-height:46px;height:200px;width:100%;text-align:right;"></textarea>
		<a href="#in-15" class="prev"><button class="btn btn-primary">&lt;</button></a>
		<a href="#in-17" class="next"><button class="btn btn-primary">&gt;</button></a>
	</div>
	<div class="input" id="in-17" style="left:2755px;top:738px;width:460px;">
		<input type="text" style="font-size:57px;height:75px;width:100%;font-weight:bold;">
		<a href="#in-16" class="prev"><button class="btn btn-primary">&lt;</button></a>
		<a href="#in-18" class="next"><button class="btn btn-primary">&gt;</button></a>
	</div>
	<div class="input" id="in-18" style="left:2755px;top:802px;width:460px;">
		<textarea style="font-size:37px;line-height:46px;height:200px;width:100%;"></textarea>
		<a href="#in-19" class="prev"><button class="btn btn-primary">&lt;</button></a>
		<a href="#in-20" class="next"><button class="btn btn-primary">&gt;</button></a>
	</div>
	<div class="input" id="in-19" style="left:2627px;top:448px;width:676px;">
		<input type="text" class="opensans" style="font-size:32px;height:44px;width:100%;text-align:center;font-weight:300;text-transform:uppercase;" size="18">
		<a href="#in-18" class="prev"><button class="btn btn-primary">&lt;</button></a>
		<a href="#in-20" class="next"><button class="btn btn-primary">&gt;</button></a>
	</div>
	<div class="input" id="in-20" style="left:2644px;top:490px;width:676px;">
		<input type="text" class="opensans" style="font-size:42px;height:48px;width:100%;text-align:center;font-weight:300;letter-spacing:14px;text-transform:uppercase;" size="18">
		<a href="#in-19" class="prev"><button class="btn btn-primary">&lt;</button></a>
		<a href="#in-21" class="next"><button class="btn btn-primary">&gt;</button></a>
	</div>
	<div class="input" id="in-21" style="left:2639px;top:532px;width:676px;">
		<input type="text" class="opensans" style="font-size:69px;height:93px;width:100%;text-align:center;letter-spacing:5px;font-weight:bold;" size="18">
		<a href="#in-20" class="prev"><button class="btn btn-primary">&lt;</button></a>
		<a href="#in-22" class="next"><button class="btn btn-primary">&gt;</button></a>
	</div>
	<div class="input" id="in-22" style="left:2742px;top:626px;width:476px;">
		<input type="text" class="opensans" style="font-size:46px;height:63px;width:100%;letter-spacing:10px;text-align:center;" size="18">
		<a href="#in-21" class="prev"><button class="btn btn-primary">&lt;</button></a>
		<a href="#logo" class="next"><button class="btn btn-primary">&gt;</button></a>
	</div>
	<div id="logo" class="input" ng-show="uid" style="width: 590px;">
		<input type="file" accept="image/*" capture="camera" id="file-upload">
		<img class="pano" id="pano" width="590" />
		<a href="#in-22" class="prev"><button class="btn btn-primary">&lt;</button></a>
		<a href="#in-1" class="next"><button class="btn btn-primary">&gt;</button></a>
	</div>
	<button id="settings" ng-show="uid" class="btn btn-circle btn-primary btn-lg" ng-click="ctrl.add()"><i class="glyphicon glyphicon-save"></i></button>
	<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
	<script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.3/angular.js"></script>
	<script src="https://cdn.firebase.com/js/client/2.2.4/firebase.js"></script>
	<script src="https://cdn.firebase.com/libs/angularfire/1.1.2/angularfire.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/ng-flow/2.6.1/ng-flow-standalone.min.js"></script>
	<script type="text/javascript">
		var app = angular.module('app', ['firebase'])
		.controller("AppCtrl", ["$rootScope", "Auth", "Ref", "$firebaseArray", "$anchorScroll", function($rootScope, Auth, Ref, $firebaseArray, $anchorScroll){
			var ctrl = this;
			this.login = function(login){
				Ref.authWithPassword(login, function(error, authData) {
					if(error){console.log(error);}else{console.log(authData);}
				});
			};
			this.logout = function(){Ref.unauth();};
			this.add = function(){
				Ref.child('/2015_Fall/'+$rootScope.uid+'/inputs/').push(
					{"left":"118","length":"8","size":"120","text":"type","top":"72","bold":false}
				);
			};
		    Auth.$onAuth(function(authData) {
		    	if(authData){
					$rootScope.uid = authData.uid;
					Ref.child('/2015_Fall/'+authData.uid+'/logo/img').once('value', function(snap) {
						var payload = snap.val();
						if (payload != null) {
							document.getElementById("pano").src = payload;
						} else {
							console.log("Not found");
						}
					});
					ctrl.inputs = $firebaseArray(Ref.child('/2015_Fall/'+$rootScope.uid+'/inputs'));
					ctrl.inputs.$loaded(function(x) {
						console.log(x);
					}, function(error) {
						console.error("Error:", error);
					});
		    	}else{
		    		$rootScope.uid = false;
		    	}
		    });
		}])
		.factory("Auth", ["$firebaseAuth", "Ref", function($firebaseAuth, Ref){return $firebaseAuth(Ref);}])
		.factory("Ref", [function (){var ref = new Firebase("https://webprint.firebaseio.com/");return ref;}]);
		function handleFileSelect(evt) {
			var f = evt.target.files[0];
			var reader = new FileReader();
			reader.onloadend = (function(file) {
			    return function(e) {
					closurefun(e, file);
				}
			})(f);
			reader.readAsDataURL(f);
			function closurefun(e, file){
				var uid = $("#uid").html();
				console.log(uid);
		    	var filePayload = e.target.result;
				var ref = new Firebase('https://webprint.firebaseio.com/2015_Fall/'+uid+'/logo/img');
				ref.set(filePayload);
				document.getElementById("pano").src = e.target.result;
			}
		}
		document.getElementById("file-upload").addEventListener('change', handleFileSelect, false);
	</script>
</body>
</html>